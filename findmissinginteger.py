# -*- coding: utf-8 -*-
"""
Created on Thu Apr 15 17:36:01 2021

@author: Rohan Prateek
"""

class Solution:
    # @param A : list of integers
    # @return an integer
    def firstMissingPositive(self, A):
        
        end = len(A) - 1 
        while A[end] < 0:
            end -= 1
            if end == -1:
                return 1
        
        ind = 0
    
        while ind < end:
            if A[ind] < 0:
                A[ind], A[end] = A[end], A[ind]
                while A[end] < 0:
                    end -= 1
                    if end == -1:
                        break
            if end == -1:
                break
            ind += 1
        A = A[:end + 1]
        B = set(A)
        if len(A) == 1:
            if A[0] == 1:
                return 2
            else:
                return 1
        for i in range(len(A)):
            if i + 1 not in B:
                return i + 1
        return len(A)
    
s = Solution()
a = [480, 620, 890, 216, 147, 271, 989, 872, 994, 488, 291, 331, 8, 769, 481, 924, 166, 89, 824, 327, 590, 416, 17, 814, 728, 18, 673, 662, 410, 727, 667, 631, 660, 625, 683, 33, 436, 930, 91, 141, 948, 138, 113, 253, 56, 432, 744, 302, 211, 262, 968, 945, 396, 240, 594, 684, 958, 343, 879, 155, 395, 288, 550, 482, 557, 826, 598, 795, 914, 892, 690, 964, 981, 150, 179, 515, 205, 265, 823, 799, 190, 236, 24, 498, 229, 420, 753, 936, 191, 366, 935, 434, 311, 920, 167, 817, 220, 219, 741, 589, 674, 330, 909, 162, 443, 412, 974, 294, 864, 971, 760, 225, 681, 689, 608, 931, 427, 687, 466, 894, 303, 390, 242, 339, 252, 20, 218, 499, 232, 184, 490, 4, 957, 597, 477, 354, 677, 691, 25, 580, 897, 542, 186, 359, 346, 409, 655, 979, 853, 411, 344, 358, 559, 765, 383, 484, 181, 82, 514, 582, 593, 77, 228, 921, 348, 453, 274, 449, 106, 657, 783, 782, 811, 333, 305, 784, 581, 746, 858, 249, 479, 652, 270, 429, 614, 903, 102, 378, 575, 119, 196, 12, 990, 356, 277, 169, 70, 518, 282, 676, 137, 622, 616, 357, 913, 161, 3, 1, 2]
print(s.firstMissingPositive(a))